# 人脸识别

## 人脸识别业务统计文档

    统计所有涉及人脸核身功能的业务
    
#### 1、人脸核身

    人脸识别入口，独立人脸识别功能的入口，用于PC端人脸识别实现个人认证

###### 流程

> 进入人脸核身页面 --> 确认进入快速验证 --> 输入个人名称和身份证进行人脸识别 --> 进入人脸识别成功页面/信息查询成功等页面

> 注：个别业务进入快速验证后直接开启人脸识别功能

#### 2、业务确认

    根据业务号查询并通过人脸识别确认业务

###### 流程

> 进入业务确认页面 --> 进入信息确认页面 --> 进入人脸核身页面

#### 3、个人产权查询

    人脸识别查询个人产权信息

###### 流程

> 直接进入人脸核身页面 --> 人脸识别成功则进入信息查询结果页面

#### 4、个人信息查询

    人脸识别查询个人信息

###### 流程

> 直接进入人脸核身页面 --> 人脸识别成功则进入信息查询结果页面

#### 5、个人产权证明下载

    通过人脸识别获取并下载个人产权证明

###### 流程

> 直接进入人脸核身页面 --> 人脸识别成功则下载个人产权证明下载


## 人脸识别统一入口设计

    设计人脸识别统一入口，即当用户人脸识别过一次后，之后所有相关业务都不需要人脸识别。
    注：当页面关闭（关闭浏览器），下次访问第一次依然要进行人脸识别

#### 使用Vuex全局状态管理

    使用Vuex全局保存人脸识别状态，当用户进行人脸识别时，判断用户是否已经进行过人脸识别。
    如果已经进行过人脸识别，直接跳过人脸识别过程进入下一步；
    如果为进行过人脸识别，则按照正常流程进行人脸识别。

###### 具体实现思路

- 1、在Vuex的state保存一个是否已经进行过人脸识别的状态，例如：flag
- 2、在进行人脸识别之前进行状态判断，即进入人脸核身页面之前，
    我们可以通过router.beforeEach路由全局钩子函数判断（可以在router配置meta属性辅助）
- 3、当即将进入的页面是人脸核身页面或要求人脸识别验证的页面，那么我们就进行state状态值判断，
    如果flag是false，则正常进入人脸核身页面；如果flag是true，则直接跳转到人脸识别页面。
- 4、在人脸识别页面mounted方法判断，抽离人脸识别成功或失败进行的内容，如果flag是true，则直接进行人脸识别成功后的操作；
    如果如果flag是false，则正常进行人脸识别

## 微信重构、新增业务流程

    重构微信人脸识别，统一业务入口，一次判断，当前周期（即页面或浏览器关闭前）都可使用
    新增支付业务

> https://www.processon.com/view/link/5a9d0710e4b0a9d22eb7776e?tdsourcetag=s_pctim_aiomsg

###### 微信重构计划

    根据上述微信流程重构微信逻辑

- 1、将微信从Vue2.*转移到Vue cli3.0，任务基本完成，剩余部分细节优化问题有待磨合
- 2、计划前端花费1-2天时间左右完成新的基本业务逻辑，即，统一微信入口，统一人脸识别认证，认证成功进入个人中心首页
- 3、对应接口实现大概要1-2天，然后前后端对接进行测试，大概花费时间3天时间左右

###### 新增业务流程实现计划

    根据上述微信流程实现微信支付业务

- 这个重要问题在接口方面，接口实现了前端直接调用接口扫码二维码即可，前端就可以增加页面功能实现接口简单调用

###### 后续计划

- 重构个人中心首页
> 这个需要考虑个人中心首页功能与设计，需要重新设计，设计好了就可以改
