# 公共文档模块接口文档

<div style="float:right">

|作者|日期|
|----|---|
|郑烨锟|2019年6月5日|

</div>

## 接口1：获取个人文件树和共享文件树


> `/getUserFileTree?userId=dc792782-9a38-412e-ab0f-d0f92a5673e9`

**请求类型**：`GET`

**请求参数**：

```js
userId="dc792782-9a38-412e-ab0f-d0f92a5673e9"
```

> userId是当前用户的ID

**返回参数**

```json
{
	"userFileTree": [
		{
			"id": "00000001-0000-0000-0010-0000000000010",
			"text": "共享文件",
			"attributes": {
				"parentId": "0",
				"fileAddress": ""	// 文件夹没有文件保存地址
			},
			"children": [
				{
					"id": "dc792782-9a38-412e-ab0f-d0f92a5673e9",
					"text": "张三",	// 张三分享给当前用户的文件(文件夹形式)
					"attributes": {
						"fileAddress": ""
					},
					children:[
						"id": "dc792782-9a38-412e-ab0f-d0f92a5673e9",
						"text": "文件名",
						"attributes": {
							"fileAddress": "http://.../fileName.*"
						}
					],
				}, {
					"id": "1ec3b9f1-ba37-474e-801d-f6f5e04a4743",
					"text": "李四",
					"attributes": {
						"fileAddress": ""
					},
					children:[
						{
							"id": "1ec3b9f1-ba37-474e-801d-f6f5e04a4743",
							"text": "文件夹名",
							"attributes": {
								"fileAddress": ""
							},
							children:[
								{
									"id": "1ec3b9f1-ba37-474e-801d-f6f5e04a4743",
									"text": "文件名",
									"attributes": {
										"fileAddress": "http://.../fileName.*"
									},
									children:[],
								}
							],
						}
					],
				}, {
					"id": "00000001-0000-0000-0010-0000000000010",
					"text": "当前用户名",		// 当前用户分享出去的文件
					"attributes": {
						"fileAddress": "http://.../fileName.*"
					},
					children:[
						// 当前用户文件树
					],
				}
			]
		}
	],
	"sharedFileTree": [
		{
			"id": "00000001-0000-0000-0010-000000000001",
			"text": "个人文件",
			"attributes": {
				"parentId": "0",
				"fileAddress": ""
			},
			"children": [
				{
					"id": "dc792782-9a38-412e-ab0f-d0f92a5673e9",
					"text": "文件名",
					"attributes": {
						"parentId": "00000001-0000-0000-0010-000000000001",
						"fileAddress": "http://.../fileName.*"
					},
					children:[],
				}, {
					"id": "1ec3b9f1-ba37-474e-801d-f6f5e04a4743",
					"text": "文件名",
					"attributes": {
						"parentId": "00000001-0000-0000-0010-000000000001",
						"fileAddress": "http://.../fileName.*"
					},
					children:[],
				}, {
					"id": "71e2d9d9-5853-4797-82e8-e5f1f4fd3afd",
					"text": "文件夹名",
					"attributes": {
						"parentId": "00000001-0000-0000-0010-000000000001",
						"fileAddress": ""
					},
					children:[
						{
							"id": "1ec3b9f1-ba37-474e-801d-f6f5e04a4743",
							"text": "文件夹名",
							"attributes": {
								"parentId": "71e2d9d9-5853-4797-82e8-e5f1f4fd3afd",
								"fileAddress": ""
							},
							children:[
								{
									"id": "1ec3b9f1-ba37-474e-801d-f6f5e04a4743",
									"text": "文件名",
									"attributes": {
										"parentId": "1ec3b9f1-ba37-474e-801d-f6f5e04a4743",
										"fileAddress": "http://.../fileName.*"
									},
									children:[],
								}
							],
						}
					],
				}
			]
		}
	]
}
```

> 注：返回json数据结构参考easyui-tree的树结构，返回数据为个人拥有的文件树和个人拥有的共享文件树

## 接口2：修改/新增目录(文件夹)名称

> `/updateFolderName`

*请求类型*：`POST`

**请求数据**

```json
{
	sUid: "00000001-0000-0000-0010-000000000001",	// 当前用户ID
	rid: "1ec3b9f1-ba37-474e-801d-f6f5e04a4743",	// 文件ID：当rid为空的时候表示`新增`
	newFileName: "新目录名",
}
```

**返回数据**

```json
{
	state: true,
	errorMessage: "错误信息！"
}
```


##接口3：上传文件

	这里会同时更新个人文件树，也就是修改个人文件树

> `/uploadFiles`

*请求类型*：`POST`

**请求数据**

```json
{
	sUid: "00000001-0000-0000-0010-000000000001",	// 当前用户ID
	pRid: "parent目录Id",	// 父级节点id
	files: "多个文件"
}
```

!> 注：这里上传文件的时候需要更新个人文件树列表

**返回数据**

```json
{
	state: true,
	errorMessage: "错误信息！"
}
```

## 接口4：删除文件或文件夹

	这里会同时更新个人文件树，也就是修改个人文件树

> `/deleteFiles?rid=1ec3b9f1-ba37-474e-801d-f6f5e04a4743`

*请求类型*：`GET`

**请求数据**

```json
rid: "文件或目录ID",	// 要删除文件或文件夹的Id
```

!> 注：这里如果是删除文件夹，连同子文件夹和文件都删除

**返回数据**

```json
{
	state: true,
	errorMessage: "错误信息！"
}
```

## 接口5：设置权限

	这里会修改个人文件树
	这里会修改共享文件树

